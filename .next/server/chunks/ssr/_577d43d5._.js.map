{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../src/app/posts/%5Bid%5D/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","'use client'\r\n\r\nimport { useState, useEffect, use } from 'react'\r\nimport Link from 'next/link'\r\n\r\n// 文章类型定义\r\ninterface Post {\r\n  id: number\r\n  title: string\r\n  excerpt: string\r\n  content: string\r\n  categoryId: number\r\n  image: string\r\n  status: 'published' | 'pending' | 'rejected'\r\n  foundSensitiveWords: string[]\r\n  createdAt: string\r\n  authorId: number\r\n  reviewedBy: number | null\r\n  reviewedAt: string | null\r\n  rejectionReason: string | null\r\n  likes: number // 点赞数\r\n  category?: { name: string; slug: string }\r\n  author?: { name: string }\r\n}\r\n\r\n// 分类类型定义\r\ninterface Category {\r\n  id: number\r\n  name: string\r\n  slug: string\r\n}\r\n\r\n// 用户类型定义\r\ninterface User {\r\n  id: number\r\n  name: string\r\n}\r\n\r\nexport default function PostDetail({ params }: { params: Promise<{ id: string }> }) {  \r\n  // 使用React.use()解包params Promise\r\n  const resolvedParams = use(params)\r\n  const postId = parseInt(resolvedParams.id)\r\n  \r\n  const [post, setPost] = useState<Post | null>(null)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  useEffect(() => {\r\n    const fetchPost = async () => {\r\n      setIsLoading(true)\r\n      setError(null)\r\n      \r\n      try {\r\n        // 从API获取文章数据\r\n        const response = await fetch('/api/posts')\r\n        if (!response.ok) {\r\n          throw new Error('Failed to fetch posts')\r\n        }\r\n        const postsData: Post[] = await response.json()\r\n        \r\n        // 为文章添加默认值\r\n        const processedPosts = postsData.map(post => ({\r\n          ...post,\r\n          status: post.status || 'published',\r\n          likes: post.likes || 0\r\n        }))\r\n        \r\n        const foundPost = processedPosts.find(p => p.id === postId)\r\n        \r\n        if (foundPost) {\r\n          setPost(foundPost)\r\n        } else {\r\n          setError('文章不存在')\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching post:', error)\r\n        setError('加载文章失败')\r\n      } finally {\r\n        setIsLoading(false)\r\n      }\r\n    }\r\n    \r\n    fetchPost()\r\n  }, [postId])\r\n\r\n  // 点赞功能\r\n  const handleLike = async () => {\r\n    if (post) {\r\n      try {\r\n        // 从API获取最新文章数据\r\n        const response = await fetch('/api/posts')\r\n        if (!response.ok) {\r\n          throw new Error('Failed to fetch posts')\r\n        }\r\n        const postsData: Post[] = await response.json()\r\n        \r\n        // 更新文章点赞数\r\n        const updatedPosts = postsData.map(p => {\r\n          if (p.id === post.id) {\r\n            return { ...p, likes: p.likes + 1 }\r\n          }\r\n          return p\r\n        })\r\n        \r\n        // 保存到全局变量（实际项目中应调用API更新）\r\n        // 这里我们直接更新状态，因为API使用的是全局变量\r\n        setPost({ ...post, likes: post.likes + 1 })\r\n      } catch (error) {\r\n        console.error('Error updating likes:', error)\r\n      }\r\n    }\r\n  }\r\n\r\n  // 加载状态\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center py-12\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // 错误状态\r\n  if (error || !post) {\r\n    return (\r\n      <div className=\"bg-white rounded-xl shadow-sm p-8 text-center\">\r\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">{error || '文章不存在'}</h2>\r\n        <Link \r\n          href=\"/\" \r\n          className=\"inline-flex items-center text-blue-600 font-medium hover:text-blue-800 transition-colors\"\r\n        >\r\n          返回首页\r\n          <svg className=\"ml-2 h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n          </svg>\r\n        </Link>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* 文章头部 */}\r\n      <article className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\r\n        {/* 文章图片 */}\r\n        {post.image && (\r\n          <div className=\"relative h-80 overflow-hidden\">\r\n            <img \r\n              src={post.image} \r\n              alt={post.title} \r\n              className=\"w-full h-full object-cover\"\r\n            />\r\n            <div className=\"absolute top-4 left-4\">\r\n              <Link \r\n                href={`/categories/${post.category?.slug || 'uncategorized'}`} \r\n                className=\"bg-blue-100 text-blue-800 text-xs font-medium px-3 py-1 rounded-full hover:bg-blue-200 transition-colors\"\r\n              >\r\n                {post.category?.name || '未分类'}\r\n              </Link>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {/* 文章内容 */}\r\n        <div className=\"p-8\">\r\n          <div className=\"flex items-center text-sm text-gray-500 mb-4\">\r\n            <span className=\"flex items-center\">\r\n              <svg className=\"w-4 h-4 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\r\n              </svg>\r\n              {new Date(post.createdAt).toLocaleDateString()}\r\n            </span>\r\n            <span className=\"mx-2\">•</span>\r\n            <span className=\"flex items-center\">\r\n              <svg className=\"w-4 h-4 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\r\n              </svg>\r\n              {post.author?.name || '未知作者'}\r\n            </span>\r\n          </div>\r\n          \r\n          <h1 className=\"text-3xl md:text-4xl font-bold text-gray-900 mb-6\">{post.title}</h1>\r\n          \r\n          <div className=\"text-gray-700 mb-8 whitespace-pre-wrap\">\r\n            {post.content}\r\n          </div>\r\n          \r\n          <div className=\"flex justify-between items-center mt-8 pt-6 border-t border-gray-200\">\r\n            <button \r\n              onClick={handleLike}\r\n              className=\"inline-flex items-center text-gray-500 hover:text-red-600 transition-colors group\"\r\n            >\r\n              <svg className=\"w-5 h-5 mr-2 transition-transform group-hover:scale-110\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\r\n              </svg>\r\n              <span>{post.likes} 点赞</span>\r\n            </button>\r\n            \r\n            <Link \r\n              href=\"/\" \r\n              className=\"inline-flex items-center text-blue-600 font-medium hover:text-blue-800 transition-colors\"\r\n            >\r\n              返回首页\r\n              <svg className=\"ml-2 h-4 w-4 transition-transform group-hover:translate-x-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n              </svg>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </article>\r\n      \r\n      {/* 相关文章 */}\r\n      <section className=\"bg-white rounded-xl shadow-sm p-8\">\r\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">相关文章</h2>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n          {/* 这里可以添加相关文章逻辑 */}\r\n          {/* 暂时显示返回首页按钮 */}\r\n          <div className=\"col-span-full text-center py-8\">\r\n            <Link \r\n              href=\"/\" \r\n              className=\"inline-flex items-center text-blue-600 font-medium hover:text-blue-800 transition-colors\"\r\n            >\r\n              <svg className=\"mr-2 h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n              </svg>\r\n              查看更多文章\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </div>\r\n  )\r\n}"],"names":["module","exports","require","vendored","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0]}