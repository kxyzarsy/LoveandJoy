module.exports=[38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},55606,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(72131),e=a.i(50247);function f(){let[a,f]=(0,d.useState)({}),[g,h]=(0,d.useState)(""),[i,j]=(0,d.useState)(""),[k,l]=(0,d.useState)(!1),[m,n]=(0,d.useState)(""),[o,p]=(0,d.useState)(0),[q,r]=(0,d.useState)(""),[s,t]=(0,d.useState)(""),[u,v]=(0,d.useState)(""),[w,x]=(0,d.useState)(""),[y,z]=(0,d.useState)(""),A=async()=>{let a=document.getElementById("email"),b=a?.value||"";if(!b||!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(b))return void n("请先输入有效的邮箱地址");l(!0),n("");try{let a=await fetch("/api/auth/send-verification-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b})}),c=await a.json();if(c.success){n(c.message),p(60);let a=setInterval(()=>{p(b=>b<=1?(clearInterval(a),0):b-1)},1e3)}else n(c.message||"验证码发送失败，请稍后重试")}catch(a){console.error("发送验证码失败:",a),n("验证码发送失败，请稍后重试")}finally{l(!1)}},B=async a=>{a.preventDefault();let b=new FormData(a.currentTarget),c=b.get("username"),d=b.get("usernameId"),g=b.get("email"),j=b.get("password"),k=b.get("confirmPassword");f({});let l={},m=JSON.parse(localStorage.getItem("users")||"[]");if(c.trim())if(c.length<3||c.length>20)l.username="用户名长度必须在3-20个字符之间";else{let a=(0,e.detectSensitiveWords)(c);a.length>0&&(l.username=`用户名包含违禁词: ${a.join(", ")}`),m.some(a=>a.username===c)&&(l.username="该用户名已被注册")}else l.username="用户名不能为空";if(d.trim()?d.length<3||d.length>20?l.usernameId="用户名ID长度必须在3-20个字符之间":/^[a-zA-Z0-9_]+$/.test(d)?m.some(a=>a.usernameId===d)&&(l.usernameId="该用户名ID已被注册"):l.usernameId="用户名ID只能包含字母、数字和下划线":l.usernameId="用户名ID不能为空",g.trim())if(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(g)){["qq.com","163.com","126.com","yeah.net","gmail.com","outlook.com","hotmail.com","sina.com","sina.cn","139.com","189.cn"].includes(g.split("@")[1].toLowerCase())||(l.email="请使用支持的邮箱服务提供商（QQ、网易、谷歌等）");let a=(0,e.detectSensitiveWords)(g);a.length>0&&(l.email=`邮箱包含违禁词: ${a.join(", ")}`),m.some(a=>a.email===g)&&(l.email="该邮箱已被注册")}else l.email="请输入有效的邮箱地址";else l.email="邮箱不能为空";if(j?j.length<6&&(l.password="密码长度不能少于6个字符"):l.password="密码不能为空",k?j!==k&&(l.confirmPassword="两次输入的密码不一致"):l.confirmPassword="请确认密码",i.trim()||(l.verificationCode="请输入验证码"),Object.keys(l).length>0)return void f(l);try{let a=await fetch(`/api/auth/send-verification-code?email=${encodeURIComponent(g)}&code=${encodeURIComponent(i)}`,{method:"GET"}),b=await a.json();if(!b.success)return void f(a=>({...a,verificationCode:b.message}))}catch(a){console.error("验证验证码失败:",a),f(a=>({...a,verificationCode:"验证码验证失败，请稍后重试"}));return}try{let a=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c,email:g,password:j,usernameId:d,avatar:"https://via.placeholder.com/100",bio:""})});if(a.ok)alert("注册成功！"),window.location.href="/login";else{let b=await a.json();h(b.error||"注册失败，请稍后重试")}}catch(a){console.error("注册失败:",a),h("注册失败，请稍后重试")}};return(0,b.jsx)("div",{className:"min-h-[calc(100vh-200px)] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"创建新账户"}),(0,b.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["或"," ",(0,b.jsx)(c.default,{href:"/login",className:"font-medium text-blue-600 hover:text-blue-500 transition-colors",children:"登录到现有账户"})]})]}),g&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:g}),(0,b.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:B,children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"用户名"}),(0,b.jsx)("input",{id:"username",name:"username",type:"text",autoComplete:"username",className:`appearance-none relative block w-full px-3 py-2 border ${a.username?"border-red-500":"border-gray-300"} placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"用户名",value:s,onChange:a=>t(a.target.value)}),a.username&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:a.username})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"usernameId",className:"block text-sm font-medium text-gray-700 mb-1",children:"用户名ID"}),(0,b.jsx)("input",{id:"usernameId",name:"usernameId",type:"text",autoComplete:"usernameId",className:`appearance-none relative block w-full px-3 py-2 border ${a.usernameId?"border-red-500":"border-gray-300"} placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"用户名ID（用于URL，如：myblog）",value:u,onChange:a=>v(a.target.value)}),a.usernameId&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:a.usernameId})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"邮箱地址"}),(0,b.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",className:`appearance-none relative block w-full px-3 py-2 border ${a.email?"border-red-500":"border-gray-300"} placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"邮箱地址",value:q,onChange:a=>r(a.target.value)}),a.email&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:a.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"密码"}),(0,b.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",className:`appearance-none relative block w-full px-3 py-2 border ${a.password?"border-red-500":"border-gray-300"} placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"密码",value:w,onChange:a=>x(a.target.value)}),a.password&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:a.password})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"确认密码"}),(0,b.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",className:`appearance-none relative block w-full px-3 py-2 border ${a.confirmPassword?"border-red-500":"border-gray-300"} placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"确认密码",value:y,onChange:a=>z(a.target.value)}),a.confirmPassword&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:a.confirmPassword})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"verificationCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"验证码"}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)("input",{id:"verificationCode",name:"verificationCode",type:"text",className:`appearance-none relative block flex-1 px-3 py-2 border ${a.verificationCode?"border-red-500":"border-gray-300"} placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"请输入验证码",value:i,onChange:a=>j(a.target.value)}),(0,b.jsx)("button",{type:"button",onClick:()=>A(),disabled:k||o>0,className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed",children:k?"发送中...":o>0?`${o}s后重试`:"发送验证码"})]}),m&&(0,b.jsx)("p",{className:`mt-1 text-sm ${m.includes("成功")?"text-green-600":"text-red-600"}`,children:m}),a.verificationCode&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:a.verificationCode})]}),(0,b.jsx)("div",{children:(0,b.jsx)("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"注册"})})]})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=_4de6db64._.js.map