{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/MyBlog/LoveandJoy/src/utils/%E8%BF%9D%E7%A6%81%E8%AF%8D%E6%A3%80%E6%B5%8B.ts"],"sourcesContent":["// 违禁词列表\r\nconst sensitiveWords = [\r\n  '骚', '贱', '傻逼', '操', 'fuck', 'shit',\r\n  '政治敏感词1', '政治敏感词2', '色情敏感词1', '色情敏感词2'\r\n];\r\n\r\n/**\r\n * 检测文本中是否包含违禁词\r\n * @param text 待检测文本\r\n * @returns 包含违禁词的数组，如果没有则返回空数组\r\n */\r\nexport const detectSensitiveWords = (text: string): string[] => {\r\n  const foundWords: string[] = [];\r\n  \r\n  sensitiveWords.forEach(word => {\r\n    const regex = new RegExp(word, 'gi');\r\n    if (regex.test(text)) {\r\n      foundWords.push(word);\r\n    }\r\n  });\r\n  \r\n  return foundWords;\r\n};\r\n\r\n/**\r\n * 检查文本是否包含违禁词\r\n * @param text 待检测文本\r\n * @returns 是否包含违禁词\r\n */\r\nexport const hasSensitiveWords = (text: string): boolean => {\r\n  return detectSensitiveWords(text).length > 0;\r\n};\r\n\r\n/**\r\n * 过滤文本中的违禁词，用*替换\r\n * @param text 待过滤文本\r\n * @returns 过滤后的文本\r\n */\r\nexport const filterSensitiveWords = (text: string): string => {\r\n  let filteredText = text;\r\n  \r\n  sensitiveWords.forEach(word => {\r\n    const regex = new RegExp(word, 'gi');\r\n    filteredText = filteredText.replace(regex, '*'.repeat(word.length));\r\n  });\r\n  \r\n  return filteredText;\r\n};"],"names":[],"mappings":"AAAA,QAAQ;;;;;;;;;AACR,MAAM,iBAAiB;IACrB;IAAK;IAAK;IAAM;IAAK;IAAQ;IAC7B;IAAU;IAAU;IAAU;CAC/B;AAOM,MAAM,uBAAuB,CAAC;IACnC,MAAM,aAAuB,EAAE;IAE/B,eAAe,OAAO,CAAC,CAAA;QACrB,MAAM,QAAQ,IAAI,OAAO,MAAM;QAC/B,IAAI,MAAM,IAAI,CAAC,OAAO;YACpB,WAAW,IAAI,CAAC;QAClB;IACF;IAEA,OAAO;AACT;AAOO,MAAM,oBAAoB,CAAC;IAChC,OAAO,qBAAqB,MAAM,MAAM,GAAG;AAC7C;AAOO,MAAM,uBAAuB,CAAC;IACnC,IAAI,eAAe;IAEnB,eAAe,OAAO,CAAC,CAAA;QACrB,MAAM,QAAQ,IAAI,OAAO,MAAM;QAC/B,eAAe,aAAa,OAAO,CAAC,OAAO,IAAI,MAAM,CAAC,KAAK,MAAM;IACnE;IAEA,OAAO;AACT"}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///D:/MyBlog/LoveandJoy/src/app/api/posts/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { detectSensitiveWords, hasSensitiveWords } from '../../../utils/违禁词检测';\n\n// 文章类型定义\ninterface Post {\n  id: number;\n  title: string;\n  excerpt: string;\n  content: string;\n  categoryId: number;\n  image: string;\n  status: 'published' | 'pending' | 'rejected';\n  foundSensitiveWords: string[];\n  createdAt: string;\n  authorId: number;\n  reviewedBy: number | null;\n  reviewedAt: string | null;\n  rejectionReason: string | null;\n  likes: number;\n  // 以下字段由系统生成\n  author?: { id: number; name: string; avatar: string };\n  category?: { id: number; name: string; slug: string };\n  comments?: Array<{\n    id: number;\n    content: string;\n    createdAt: Date;\n    author: { name: string; avatar: string };\n    replies?: Array<{\n      id: number;\n      content: string;\n      createdAt: Date;\n      author: { name: string; avatar: string };\n    }>;\n  }>;\n}\n\n// 使用全局变量存储文章数据（实际项目中应使用数据库）\nlet posts: Post[] = [\n  {\n    id: 1,\n    title: '欢迎来到我的博客',\n    excerpt: '这是我的第一篇博客文章，我将在这里分享我的生活和思考。',\n    content: '<p>这是我的第一篇博客文章，我将在这里分享我的生活和思考。</p><p>博客是一个很好的平台，可以记录自己的成长历程，分享自己的经验和见解，与他人交流和学习。</p>',\n    categoryId: 1,\n    image: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=400&fit=crop',\n    status: 'published',\n    foundSensitiveWords: [],\n    createdAt: new Date().toISOString(),\n    authorId: 1,\n    reviewedBy: null,\n    reviewedAt: null,\n    rejectionReason: null,\n    likes: 0,\n    author: { id: 1, name: '博主', avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop' },\n    category: { id: 1, name: '生活', slug: 'life' },\n    comments: []\n  }\n];\n\n// 获取所有文章\nexport async function GET() {\n  try {\n    return NextResponse.json(posts);\n  } catch (error) {\n    console.error('Error fetching posts:', error);\n    return NextResponse.json({ error: 'Failed to fetch posts' }, { status: 500 });\n  }\n}\n\n// 创建新文章\nexport async function POST(request: Request) {\n  try {\n    const postData = await request.json();\n\n    // 检测违禁词\n    const allText = `${postData.title} ${postData.excerpt} ${postData.content}`;\n    const foundWords = detectSensitiveWords(allText);\n    const hasSensitive = hasSensitiveWords(allText);\n\n    // 生成新文章，确保含有违禁词的文章状态为pending\n    const newPost: Post = {\n      id: posts.length + 1,\n      title: postData.title,\n      excerpt: postData.excerpt,\n      content: postData.content,\n      categoryId: postData.categoryId,\n      image: postData.image,\n      status: hasSensitive ? 'pending' : postData.status,\n      foundSensitiveWords: foundWords,\n      createdAt: postData.createdAt || new Date().toISOString(),\n      authorId: postData.authorId,\n      reviewedBy: postData.reviewedBy || null,\n      reviewedAt: postData.reviewedAt || null,\n      rejectionReason: postData.rejectionReason || null,\n      likes: postData.likes || 0,\n      // 系统生成字段\n      author: { id: postData.authorId, name: '博主', avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop' },\n      category: { id: postData.categoryId, name: '技术', slug: 'tech' },\n      comments: []\n    };\n\n    // 保存文章到全局变量（实际项目中应保存到数据库）\n    posts.push(newPost);\n    console.log('发布文章:', newPost);\n\n    return NextResponse.json(newPost, { status: 201 });\n  } catch (error) {\n    console.error('Error creating post:', error);\n    return NextResponse.json({ error: 'Failed to create post' }, { status: 500 });\n  }\n}\n\n// 删除文章\nexport async function DELETE(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const postId = parseInt(searchParams.get('id') || '0');\n\n    if (!postId) {\n      return NextResponse.json({ error: 'Invalid post ID' }, { status: 400 });\n    }\n\n    // 查找文章索引\n    const postIndex = posts.findIndex(post => post.id === postId);\n    if (postIndex === -1) {\n      return NextResponse.json({ error: 'Post not found' }, { status: 404 });\n    }\n\n    // 从全局变量中删除文章（实际项目中应从数据库删除）\n    posts.splice(postIndex, 1);\n    console.log('删除文章:', postId);\n\n    return NextResponse.json({ message: 'Post deleted successfully' }, { status: 200 });\n  } catch (error) {\n    console.error('Error deleting post:', error);\n    return NextResponse.json({ error: 'Failed to delete post' }, { status: 500 });\n  }\n}"],"names":[],"mappings":"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"}}]
}