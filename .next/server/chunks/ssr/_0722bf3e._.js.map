{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../src/app/login/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","'use client'\r\nimport Link from 'next/link'\r\nimport { useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\n\r\nexport default function LoginPage() {\r\n  const router = useRouter()\r\n  const [email, setEmail] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [error, setError] = useState('')\r\n  const [isLoading, setIsLoading] = useState(false)\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault()\r\n    setIsLoading(true)\r\n    setError('')\r\n\r\n    try {\r\n      // 调用真实的登录API\r\n      const loginResponse = await fetch('/api/auth/login', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ email, password })\r\n      })\r\n\r\n      const loginResult = await loginResponse.json()\r\n      \r\n      if (loginResult.success) {\r\n        // 保存登录状态到localStorage\r\n        localStorage.setItem('isLoggedIn', 'true')\r\n        \r\n        // 获取完整的用户信息\r\n        const userId = loginResult.data.userInfo.id;\r\n        const userDetailsResponse = await fetch(`/api/users/${userId}`);\r\n        \r\n        if (userDetailsResponse.ok) {\r\n          const userDetails = await userDetailsResponse.json();\r\n          // 保存完整的用户数据到localStorage\r\n          localStorage.setItem('user', JSON.stringify(userDetails));\r\n        } else {\r\n          // 如果获取详情失败，使用登录API返回的用户信息\r\n          localStorage.setItem('user', JSON.stringify(loginResult.data.userInfo));\r\n        }\r\n        \r\n        // 触发自定义事件，通知Navigation组件更新用户信息\r\n        window.dispatchEvent(new Event('userLoggedIn'))\r\n\r\n        // 普通用户跳转到首页\r\n        try {\r\n          // 只使用router.push进行客户端导航，避免双重跳转导致的问题\r\n          router.push('/')\r\n        } catch (error) {\r\n          console.error('Router push failed:', error)\r\n          window.location.href = '/'\r\n        }\r\n      } else {\r\n        // 显示API返回的真实错误信息\r\n        setError(loginResult.message || '登录失败，请稍后重试')\r\n      }\r\n    } catch (err) {\r\n      setError('登录失败，请重试')\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-[calc(100vh-200px)] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-md w-full space-y-8\">\r\n        <div>\r\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\r\n            登录到您的账户\r\n          </h2>\r\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\r\n            或{' '}\r\n            <Link href=\"/register\" className=\"font-medium text-blue-600 hover:text-blue-500 transition-colors\">\r\n              创建一个新账户\r\n            </Link>\r\n          </p>\r\n        </div>\r\n        {error && (\r\n          <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\r\n          <input type=\"hidden\" name=\"remember\" defaultValue=\"true\" />\r\n          <div className=\"rounded-md -space-y-px\">\r\n            <div>\r\n              <label htmlFor=\"email\" className=\"sr-only\">\r\n                邮箱地址\r\n              </label>\r\n              <input\r\n                id=\"email\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                autoComplete=\"email\"\r\n                required\r\n                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm\"\r\n                placeholder=\"邮箱地址\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label htmlFor=\"password\" className=\"sr-only\">\r\n                密码\r\n              </label>\r\n              <input\r\n                id=\"password\"\r\n                name=\"password\"\r\n                type=\"password\"\r\n                autoComplete=\"current-password\"\r\n                required\r\n                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm\"\r\n                placeholder=\"密码\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                id=\"remember-me\"\r\n                name=\"remember-me\"\r\n                type=\"checkbox\"\r\n                className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n              />\r\n              <label htmlFor=\"remember-me\" className=\"ml-2 block text-sm text-gray-900\">\r\n                记住我\r\n              </label>\r\n            </div>\r\n\r\n            <div className=\"text-sm\">\r\n              <Link href=\"/forgot-password\" className=\"font-medium text-blue-600 hover:text-blue-500 transition-colors\">\r\n                忘记密码？\r\n              </Link>\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isLoading}\r\n              className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-70 disabled:cursor-not-allowed\"\r\n            >\r\n              {isLoading ? '登录中...' : '登录'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":["module","exports","require","vendored","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0]}