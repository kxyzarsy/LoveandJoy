module.exports=[19251,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(50247);let f=[{id:1,name:"技术",slug:"tech"},{id:2,name:"生活",slug:"life"},{id:3,name:"学习",slug:"study"},{id:4,name:"工作",slug:"work"}];function g(){let a=(0,d.useRouter)(),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(1),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let b="true"===localStorage.getItem("isLoggedIn"),c=JSON.parse(localStorage.getItem("user")||"null");if(!b||!c)return void a.push("/login")},[a]);let C=async b=>{b.preventDefault(),r(!0),t(""),v(""),x(!1),z(!1),B(!1);try{if(g&&i&&k){let b=`${g} ${i} ${k}`,c=(0,e.hasSensitiveWords)(b),d=(0,e.detectSensitiveWords)(b);await new Promise(a=>setTimeout(a,1e3));let f=c?"pending":"published",h={title:g,excerpt:i,content:k,categoryId:m,image:o,status:f,foundSensitiveWords:d,createdAt:new Date().toISOString(),authorId:1,reviewedBy:null,reviewedAt:null,rejectionReason:null,likes:0},j=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!j.ok)throw Error("发布文章失败");let l=await j.json();x(!0),B(c),setTimeout(()=>{v("文章已成功发布"),c&&z(!0),c?setTimeout(()=>{a.push("/users/1")},3e3):setTimeout(()=>{a.push(`/posts/${l.id}`)},2e3)},1500)}else t("请填写所有必填字段")}catch(a){t("发布文章失败，请重试")}finally{r(!1)}};return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"发布新文章"}),(0,b.jsx)("button",{onClick:()=>a.back(),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-md transition-colors",children:"返回"})]}),s&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:s}),w&&(0,b.jsx)("div",{className:"flex justify-center items-center mb-6 py-12",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-24 h-24 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-12 h-12 text-green-500 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})}),u&&(0,b.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md mb-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,b.jsx)("span",{children:u})]})}),y&&(0,b.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-md mb-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,b.jsx)("span",{children:"该文章含有违禁词，需要通过审核才能正常发布"})]})}),(0,b.jsxs)("form",{className:"space-y-6",onSubmit:C,children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章标题"}),(0,b.jsx)("input",{id:"title",name:"title",type:"text",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入文章标题",value:g,onChange:a=>h(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"excerpt",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章摘要"}),(0,b.jsx)("textarea",{id:"excerpt",name:"excerpt",rows:3,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"请输入文章摘要",value:i,onChange:a=>j(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章内容"}),(0,b.jsx)("textarea",{id:"content",name:"content",rows:10,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"请输入文章内容",value:k,onChange:a=>l(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章分类"}),(0,b.jsx)("select",{id:"category",name:"category",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m,onChange:a=>n(parseInt(a.target.value)),children:f.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"image",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章图片 URL"}),(0,b.jsx)("input",{id:"image",name:"image",type:"url",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入文章图片 URL",value:o,onChange:a=>p(a.target.value)})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)("button",{type:"submit",disabled:q,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:q?"发布中...":"发布文章"})})]})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=src_app_admin_posts_new_page_tsx_80c74c3d._.js.map