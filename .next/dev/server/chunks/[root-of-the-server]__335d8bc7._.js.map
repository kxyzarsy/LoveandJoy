{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///D:/MyBlog/LoveandJoy/src/app/api/send-admin-credentials/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport nodemailer from 'nodemailer';\r\n\r\n/**\r\n * 发送管理员凭证邮件的API路由\r\n * 用于定期发送管理员登录凭证和测试邮件发送\r\n */\r\nexport async function POST(request: Request) {\r\n  try {\r\n    const { isTest = false } = await request.json();\r\n    \r\n    // 管理员凭证信息\r\n    const adminCredentials = {\r\n      accessUrl: '/admin/secret-login',\r\n      initialPassword: 'admin-portal',\r\n      username: 'admin',\r\n      password: 'admin123',\r\n      secretKey: 'default-secret-key'\r\n    };\r\n    \r\n    // 创建邮件传输器\r\n    const transporter = nodemailer.createTransport({\r\n      host: 'smtp.163.com',\r\n      port: 465,\r\n      secure: true,\r\n      auth: {\r\n        user: 'kxyatxy116@163.com',\r\n        pass: 'MCGPa6nsWUCy8dGR'\r\n      }\r\n    });\r\n    \r\n    // 邮件主题\r\n    const subject = isTest \r\n      ? '【测试】管理员凭证信息' \r\n      : '【定期通知】管理员登录凭证信息';\r\n    \r\n    // 发送邮件\r\n    await transporter.sendMail({\r\n      from: 'kxyatxy116@163.com',\r\n      to: 'kxyatxy116@163.com',\r\n      subject,\r\n      html: `\r\n        <h2>管理员登录凭证信息</h2>\r\n        <p>以下是您的管理员登录凭证，请妥善保管：</p>\r\n        <table style=\"border-collapse: collapse; width: 100%; margin: 20px 0;\">\r\n          <tr style=\"background-color: #f2f2f2;\">\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">项目</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">值</th>\r\n          </tr>\r\n          <tr>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">访问地址</td>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px; font-family: monospace;\">${adminCredentials.accessUrl}</td>\r\n          </tr>\r\n          <tr style=\"background-color: #f9f9f9;\">\r\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">初始访问密码</td>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px; font-family: monospace;\">${adminCredentials.initialPassword}</td>\r\n          </tr>\r\n          <tr>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">管理员账号</td>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px; font-family: monospace;\">${adminCredentials.username}</td>\r\n          </tr>\r\n          <tr style=\"background-color: #f9f9f9;\">\r\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">管理员密码</td>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px; font-family: monospace;\">${adminCredentials.password}</td>\r\n          </tr>\r\n          <tr>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">管理员秘钥</td>\r\n            <td style=\"border: 1px solid #ddd; padding: 8px; font-family: monospace;\">${adminCredentials.secretKey}</td>\r\n          </tr>\r\n        </table>\r\n        <p><strong>重要提示：</strong>请妥善保管这些凭证，不要泄露给他人。</p>\r\n        <p>此邮件由系统自动发送，请勿回复。</p>\r\n        <hr>\r\n        <p>发送时间：${new Date().toLocaleString('zh-CN')}</p>\r\n        ${isTest ? '<p><strong>测试邮件：</strong>这是一封测试邮件，用于验证邮件系统功能。</p>' : ''}\r\n      `\r\n    });\r\n    \r\n    return NextResponse.json({ \r\n      success: true, \r\n      message: isTest ? '测试邮件发送成功' : '管理员凭证邮件发送成功' \r\n    });\r\n  } catch (error) {\r\n    console.error('发送邮件失败:', error);\r\n    return NextResponse.json({ error: '发送邮件失败' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAMO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,SAAS,KAAK,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE7C,UAAU;QACV,MAAM,mBAAmB;YACvB,WAAW;YACX,iBAAiB;YACjB,UAAU;YACV,UAAU;YACV,WAAW;QACb;QAEA,UAAU;QACV,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;YAC7C,MAAM;YACN,MAAM;YACN,QAAQ;YACR,MAAM;gBACJ,MAAM;gBACN,MAAM;YACR;QACF;QAEA,OAAO;QACP,MAAM,UAAU,SACZ,gBACA;QAEJ,OAAO;QACP,MAAM,YAAY,QAAQ,CAAC;YACzB,MAAM;YACN,IAAI;YACJ;YACA,MAAM,CAAC;;;;;;;;;;sFAUyE,EAAE,iBAAiB,SAAS,CAAC;;;;sFAI7B,EAAE,iBAAiB,eAAe,CAAC;;;;sFAInC,EAAE,iBAAiB,QAAQ,CAAC;;;;sFAI5B,EAAE,iBAAiB,QAAQ,CAAC;;;;sFAI5B,EAAE,iBAAiB,SAAS,CAAC;;;;;;gBAMnG,EAAE,IAAI,OAAO,cAAc,CAAC,SAAS;QAC7C,EAAE,SAAS,sDAAsD,GAAG;MACtE,CAAC;QACH;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS,SAAS,aAAa;QACjC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,WAAW;QACzB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAS,GAAG;YAAE,QAAQ;QAAI;IAC9D;AACF"}}]
}