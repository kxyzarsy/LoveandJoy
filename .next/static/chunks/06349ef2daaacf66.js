(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43828,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),l=e.i(93179);let n=[{id:1,name:"技术",slug:"tech"},{id:2,name:"生活",slug:"life"},{id:3,name:"学习",slug:"study"},{id:4,name:"工作",slug:"work"}];function o(){let e=(0,s.useRouter)(),[o,a]=(0,r.useState)(""),[i,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[m,x]=(0,r.useState)(1),[g,b]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[f,j]=(0,r.useState)(""),[y,v]=(0,r.useState)(""),[w,N]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1),[L,C]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let t="true"===localStorage.getItem("isLoggedIn"),r=JSON.parse(localStorage.getItem("user")||"null");if(!t||!r)return void e.push("/login")},[e]);let T=async t=>{t.preventDefault(),p(!0),j(""),v(""),N(!1),k(!1),C(!1);try{if(o&&i&&c){let t=`${o} ${i} ${c}`,r=(0,l.hasSensitiveWords)(t),s=(0,l.detectSensitiveWords)(t);await new Promise(e=>setTimeout(e,1e3));let n=r?"pending":"published",a={title:o,excerpt:i,content:c,categoryId:m,image:g,status:n,foundSensitiveWords:s,createdAt:new Date().toISOString(),authorId:1,reviewedBy:null,reviewedAt:null,rejectionReason:null,likes:0},d=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw Error("发布文章失败");let u=await d.json();N(!0),C(r),setTimeout(()=>{v("文章已成功发布"),r&&k(!0),r?setTimeout(()=>{e.push("/users/1")},3e3):setTimeout(()=>{e.push(`/posts/${u.id}`)},2e3)},1500)}else j("请填写所有必填字段")}catch(e){j("发布文章失败，请重试")}finally{p(!1)}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"发布新文章"}),(0,t.jsx)("button",{onClick:()=>e.back(),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-md transition-colors",children:"返回"})]}),f&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:f}),w&&(0,t.jsx)("div",{className:"flex justify-center items-center mb-6 py-12",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-24 h-24 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-12 h-12 text-green-500 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})}),y&&(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md mb-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,t.jsx)("span",{children:y})]})}),S&&(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-md mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,t.jsx)("span",{children:"该文章含有违禁词，需要通过审核才能正常发布"})]})}),(0,t.jsxs)("form",{className:"space-y-6",onSubmit:T,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章标题"}),(0,t.jsx)("input",{id:"title",name:"title",type:"text",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入文章标题",value:o,onChange:e=>a(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"excerpt",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章摘要"}),(0,t.jsx)("textarea",{id:"excerpt",name:"excerpt",rows:3,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"请输入文章摘要",value:i,onChange:e=>d(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章内容"}),(0,t.jsx)("textarea",{id:"content",name:"content",rows:10,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"请输入文章内容",value:c,onChange:e=>u(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章分类"}),(0,t.jsx)("select",{id:"category",name:"category",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m,onChange:e=>x(parseInt(e.target.value)),children:n.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"image",className:"block text-sm font-medium text-gray-700 mb-1",children:"文章图片 URL"}),(0,t.jsx)("input",{id:"image",name:"image",type:"url",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"请输入文章图片 URL",value:g,onChange:e=>b(e.target.value)})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"submit",disabled:h,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:h?"发布中...":"发布文章"})})]})]})}e.s(["default",()=>o])}]);